{"ast":null,"code":"var _jsxFileName = \"/Users/yadvendrayadav/Desktop/nft-marketplace/src/frontend/components/MyPurchases.js\";\nimport { useState, useEffect } from 'react';\nimport { ethers } from \"ethers\";\nimport { Row, Col, Card } from 'react-bootstrap';\nexport default function MyPurchases(_ref) {\n  let {\n    marketplace,\n    nft,\n    account\n  } = _ref;\n  const [loading, setLoading] = useState(true);\n  const [purchases, setPurchases] = useState([]);\n  const loadPurchasedItems = async () => {\n    // Fetch purchased items from marketplace by quering Offered events with the buyer set as the user\n    const filter = marketplace.filters.Bought(null, null, null, null, null, account);\n    const results = await marketplace.queryFilter(filter);\n    //Fetch metadata of each nft and add that to listedItem object.\n    const purchases = await Promise.all(results.map(async i => {\n      // fetch arguments from each result\n      i = i.args;\n      // get uri url from nft contract\n      const uri = await nft.tokenURI(i.tokenId);\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri);\n      const metadata = await response.json();\n      // get total price of item (item price + fee)\n      const totalPrice = await marketplace.getTotalPrice(i.itemId);\n      // define listed item object\n      let purchasedItem = {\n        totalPrice,\n        price: i.price,\n        itemId: i.itemId,\n        name: metadata.name,\n        description: metadata.description,\n        image: metadata.image\n      };\n      return purchasedItem;\n    }));\n    setLoading(false);\n    setPurchases(purchases);\n  };\n  useEffect(() => {\n    loadPurchasedItems();\n  }, []);\n  if (loading) return /*#__PURE__*/React.createElement(\"main\", {\n    style: {\n      padding: \"1rem 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }\n  }, \"Loading...\"));\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex justify-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }\n  }, purchases.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"px-5 container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    xs: 1,\n    md: 2,\n    lg: 4,\n    className: \"g-4 py-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 11\n    }\n  }, purchases.map((item, idx) => /*#__PURE__*/React.createElement(Col, {\n    key: idx,\n    className: \"overflow-hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Card.Img, {\n    variant: \"top\",\n    src: item.image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(Card.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 19\n    }\n  }, ethers.utils.formatEther(item.totalPrice), \" ETH\")))))) : /*#__PURE__*/React.createElement(\"main\", {\n    style: {\n      padding: \"1rem 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  }, \"No purchases\")));\n}","map":{"version":3,"names":["useState","useEffect","ethers","Row","Col","Card","MyPurchases","_ref","marketplace","nft","account","loading","setLoading","purchases","setPurchases","loadPurchasedItems","filter","filters","Bought","results","queryFilter","Promise","all","map","i","args","uri","tokenURI","tokenId","response","fetch","metadata","json","totalPrice","getTotalPrice","itemId","purchasedItem","price","name","description","image","React","createElement","style","padding","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","className","length","xs","md","lg","item","idx","key","Img","variant","src","Footer","utils","formatEther"],"sources":["/Users/yadvendrayadav/Desktop/nft-marketplace/src/frontend/components/MyPurchases.js"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { ethers } from \"ethers\"\nimport { Row, Col, Card } from 'react-bootstrap'\n\nexport default function MyPurchases({ marketplace, nft, account }) {\n  const [loading, setLoading] = useState(true)\n  const [purchases, setPurchases] = useState([])\n  const loadPurchasedItems = async () => {\n    // Fetch purchased items from marketplace by quering Offered events with the buyer set as the user\n    const filter =  marketplace.filters.Bought(null,null,null,null,null,account)\n    const results = await marketplace.queryFilter(filter)\n    //Fetch metadata of each nft and add that to listedItem object.\n    const purchases = await Promise.all(results.map(async i => {\n      // fetch arguments from each result\n      i = i.args\n      // get uri url from nft contract\n      const uri = await nft.tokenURI(i.tokenId)\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri)\n      const metadata = await response.json()\n      // get total price of item (item price + fee)\n      const totalPrice = await marketplace.getTotalPrice(i.itemId)\n      // define listed item object\n      let purchasedItem = {\n        totalPrice,\n        price: i.price,\n        itemId: i.itemId,\n        name: metadata.name,\n        description: metadata.description,\n        image: metadata.image\n      }\n      return purchasedItem\n    }))\n    setLoading(false)\n    setPurchases(purchases)\n  }\n  useEffect(() => {\n    loadPurchasedItems()\n  }, [])\n  if (loading) return (\n    <main style={{ padding: \"1rem 0\" }}>\n      <h2>Loading...</h2>\n    </main>\n  )\n  return (\n    <div className=\"flex justify-center\">\n      {purchases.length > 0 ?\n        <div className=\"px-5 container\">\n          <Row xs={1} md={2} lg={4} className=\"g-4 py-5\">\n            {purchases.map((item, idx) => (\n              <Col key={idx} className=\"overflow-hidden\">\n                <Card>\n                  <Card.Img variant=\"top\" src={item.image} />\n                  <Card.Footer>{ethers.utils.formatEther(item.totalPrice)} ETH</Card.Footer>\n                </Card>\n              </Col>\n            ))}\n          </Row>\n        </div>\n        : (\n          <main style={{ padding: \"1rem 0\" }}>\n            <h2>No purchases</h2>\n          </main>\n        )}\n    </div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}